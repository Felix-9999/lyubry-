{"ast":null,"code":"const defLimit = require('os').cpus().length;\nconst callLimit = (queue, limit = defLimit) => new Promise((res, rej) => {\n  let active = 0;\n  let current = 0;\n  const results = [];\n  let rejected = false;\n  const reject = er => {\n    if (rejected) return;\n    rejected = true;\n    rej(er);\n  };\n  let resolved = false;\n  const resolve = () => {\n    if (resolved || active > 0) return;\n    resolved = true;\n    res(results);\n  };\n  const run = () => {\n    const c = current++;\n    if (c >= queue.length) {\n      return resolve();\n    }\n    active++;\n    results[c] = queue[c]().then(result => {\n      active--;\n      results[c] = result;\n      run();\n      return result;\n    }, reject);\n  };\n  for (let i = 0; i < limit; i++) {\n    run();\n  }\n});\nmodule.exports = callLimit;","map":{"version":3,"names":["defLimit","require","cpus","length","callLimit","queue","limit","Promise","res","rej","active","current","results","rejected","reject","er","resolved","resolve","run","c","then","result","i","module","exports"],"sources":["C:/Users/Felo/node_modules/npm/node_modules/promise-call-limit/index.js"],"sourcesContent":["const defLimit = require('os').cpus().length\nconst callLimit = (queue, limit = defLimit) => new Promise((res, rej) => {\n  let active = 0\n  let current = 0\n  const results = []\n\n  let rejected = false\n  const reject = er => {\n    if (rejected)\n      return\n    rejected = true\n    rej(er)\n  }\n\n  let resolved = false\n  const resolve = () => {\n    if (resolved || active > 0)\n      return\n    resolved = true\n    res(results)\n  }\n\n  const run = () => {\n    const c = current++\n    if (c >= queue.length) {\n      return resolve()\n    }\n\n    active ++\n    results[c] = queue[c]().then(result => {\n      active --\n      results[c] = result\n      run()\n      return result\n    }, reject)\n  }\n\n  for (let i = 0; i < limit; i++) {\n    run()\n  }\n})\n\nmodule.exports = callLimit\n"],"mappings":"AAAA,MAAMA,QAAQ,GAAGC,OAAO,CAAC,IAAI,CAAC,CAACC,IAAI,CAAC,CAAC,CAACC,MAAM;AAC5C,MAAMC,SAAS,GAAGA,CAACC,KAAK,EAAEC,KAAK,GAAGN,QAAQ,KAAK,IAAIO,OAAO,CAAC,CAACC,GAAG,EAAEC,GAAG,KAAK;EACvE,IAAIC,MAAM,GAAG,CAAC;EACd,IAAIC,OAAO,GAAG,CAAC;EACf,MAAMC,OAAO,GAAG,EAAE;EAElB,IAAIC,QAAQ,GAAG,KAAK;EACpB,MAAMC,MAAM,GAAGC,EAAE,IAAI;IACnB,IAAIF,QAAQ,EACV;IACFA,QAAQ,GAAG,IAAI;IACfJ,GAAG,CAACM,EAAE,CAAC;EACT,CAAC;EAED,IAAIC,QAAQ,GAAG,KAAK;EACpB,MAAMC,OAAO,GAAGA,CAAA,KAAM;IACpB,IAAID,QAAQ,IAAIN,MAAM,GAAG,CAAC,EACxB;IACFM,QAAQ,GAAG,IAAI;IACfR,GAAG,CAACI,OAAO,CAAC;EACd,CAAC;EAED,MAAMM,GAAG,GAAGA,CAAA,KAAM;IAChB,MAAMC,CAAC,GAAGR,OAAO,EAAE;IACnB,IAAIQ,CAAC,IAAId,KAAK,CAACF,MAAM,EAAE;MACrB,OAAOc,OAAO,CAAC,CAAC;IAClB;IAEAP,MAAM,EAAG;IACTE,OAAO,CAACO,CAAC,CAAC,GAAGd,KAAK,CAACc,CAAC,CAAC,CAAC,CAAC,CAACC,IAAI,CAACC,MAAM,IAAI;MACrCX,MAAM,EAAG;MACTE,OAAO,CAACO,CAAC,CAAC,GAAGE,MAAM;MACnBH,GAAG,CAAC,CAAC;MACL,OAAOG,MAAM;IACf,CAAC,EAAEP,MAAM,CAAC;EACZ,CAAC;EAED,KAAK,IAAIQ,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGhB,KAAK,EAAEgB,CAAC,EAAE,EAAE;IAC9BJ,GAAG,CAAC,CAAC;EACP;AACF,CAAC,CAAC;AAEFK,MAAM,CAACC,OAAO,GAAGpB,SAAS","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}