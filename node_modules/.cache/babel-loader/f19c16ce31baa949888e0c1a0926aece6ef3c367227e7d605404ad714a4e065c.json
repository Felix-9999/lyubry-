{"ast":null,"code":"const spawn = require('@npmcli/promise-spawn');\nconst promiseRetry = require('promise-retry');\nconst makeError = require('./make-error.js');\nconst whichGit = require('./which.js');\nconst makeOpts = require('./opts.js');\nconst procLog = require('./proc-log.js');\nmodule.exports = (gitArgs, opts = {}) => {\n  const gitPath = whichGit(opts);\n  if (gitPath instanceof Error) {\n    return Promise.reject(gitPath);\n  }\n\n  // undocumented option, mostly only here for tests\n  const args = opts.allowReplace || gitArgs[0] === '--no-replace-objects' ? gitArgs : ['--no-replace-objects', ...gitArgs];\n  const log = opts.log || procLog;\n  let retry = opts.retry;\n  if (retry === null || retry === undefined) {\n    retry = {\n      retries: opts.fetchRetries || 2,\n      factor: opts.fetchRetryFactor || 10,\n      maxTimeout: opts.fetchRetryMaxtimeout || 60000,\n      minTimeout: opts.fetchRetryMintimeout || 1000\n    };\n  }\n  return promiseRetry((retry, number) => {\n    if (number !== 1) {\n      log.silly('git', `Retrying git command: ${args.join(' ')} attempt # ${number}`);\n    }\n    return spawn(gitPath, args, makeOpts(opts)).catch(er => {\n      const gitError = makeError(er);\n      if (!gitError.shouldRetry(number)) {\n        throw gitError;\n      }\n      retry(gitError);\n    });\n  }, retry);\n};","map":{"version":3,"names":["spawn","require","promiseRetry","makeError","whichGit","makeOpts","procLog","module","exports","gitArgs","opts","gitPath","Error","Promise","reject","args","allowReplace","log","retry","undefined","retries","fetchRetries","factor","fetchRetryFactor","maxTimeout","fetchRetryMaxtimeout","minTimeout","fetchRetryMintimeout","number","silly","join","catch","er","gitError","shouldRetry"],"sources":["C:/Users/Felo/node_modules/npm/node_modules/@npmcli/git/lib/spawn.js"],"sourcesContent":["const spawn = require('@npmcli/promise-spawn')\nconst promiseRetry = require('promise-retry')\nconst makeError = require('./make-error.js')\nconst whichGit = require('./which.js')\nconst makeOpts = require('./opts.js')\nconst procLog = require('./proc-log.js')\n\nmodule.exports = (gitArgs, opts = {}) => {\n  const gitPath = whichGit(opts)\n\n  if (gitPath instanceof Error) { return Promise.reject(gitPath) }\n\n  // undocumented option, mostly only here for tests\n  const args = opts.allowReplace || gitArgs[0] === '--no-replace-objects'\n    ? gitArgs\n    : ['--no-replace-objects', ...gitArgs]\n\n  const log = opts.log || procLog\n  let retry = opts.retry\n  if (retry === null || retry === undefined) {\n    retry = {\n      retries: opts.fetchRetries || 2,\n      factor: opts.fetchRetryFactor || 10,\n      maxTimeout: opts.fetchRetryMaxtimeout || 60000,\n      minTimeout: opts.fetchRetryMintimeout || 1000\n    }\n  }\n  return promiseRetry((retry, number) => {\n    if (number !== 1) {\n      log.silly('git', `Retrying git command: ${\n        args.join(' ')} attempt # ${number}`)\n    }\n\n    return spawn(gitPath, args, makeOpts(opts))\n      .catch(er => {\n        const gitError = makeError(er)\n        if (!gitError.shouldRetry(number)) {\n          throw gitError\n        }\n        retry(gitError)\n      })\n  }, retry)\n}\n"],"mappings":"AAAA,MAAMA,KAAK,GAAGC,OAAO,CAAC,uBAAuB,CAAC;AAC9C,MAAMC,YAAY,GAAGD,OAAO,CAAC,eAAe,CAAC;AAC7C,MAAME,SAAS,GAAGF,OAAO,CAAC,iBAAiB,CAAC;AAC5C,MAAMG,QAAQ,GAAGH,OAAO,CAAC,YAAY,CAAC;AACtC,MAAMI,QAAQ,GAAGJ,OAAO,CAAC,WAAW,CAAC;AACrC,MAAMK,OAAO,GAAGL,OAAO,CAAC,eAAe,CAAC;AAExCM,MAAM,CAACC,OAAO,GAAG,CAACC,OAAO,EAAEC,IAAI,GAAG,CAAC,CAAC,KAAK;EACvC,MAAMC,OAAO,GAAGP,QAAQ,CAACM,IAAI,CAAC;EAE9B,IAAIC,OAAO,YAAYC,KAAK,EAAE;IAAE,OAAOC,OAAO,CAACC,MAAM,CAACH,OAAO,CAAC;EAAC;;EAE/D;EACA,MAAMI,IAAI,GAAGL,IAAI,CAACM,YAAY,IAAIP,OAAO,CAAC,CAAC,CAAC,KAAK,sBAAsB,GACnEA,OAAO,GACP,CAAC,sBAAsB,EAAE,GAAGA,OAAO,CAAC;EAExC,MAAMQ,GAAG,GAAGP,IAAI,CAACO,GAAG,IAAIX,OAAO;EAC/B,IAAIY,KAAK,GAAGR,IAAI,CAACQ,KAAK;EACtB,IAAIA,KAAK,KAAK,IAAI,IAAIA,KAAK,KAAKC,SAAS,EAAE;IACzCD,KAAK,GAAG;MACNE,OAAO,EAAEV,IAAI,CAACW,YAAY,IAAI,CAAC;MAC/BC,MAAM,EAAEZ,IAAI,CAACa,gBAAgB,IAAI,EAAE;MACnCC,UAAU,EAAEd,IAAI,CAACe,oBAAoB,IAAI,KAAK;MAC9CC,UAAU,EAAEhB,IAAI,CAACiB,oBAAoB,IAAI;IAC3C,CAAC;EACH;EACA,OAAOzB,YAAY,CAAC,CAACgB,KAAK,EAAEU,MAAM,KAAK;IACrC,IAAIA,MAAM,KAAK,CAAC,EAAE;MAChBX,GAAG,CAACY,KAAK,CAAC,KAAK,EAAE,yBACfd,IAAI,CAACe,IAAI,CAAC,GAAG,CAAC,cAAcF,MAAM,EAAE,CAAC;IACzC;IAEA,OAAO5B,KAAK,CAACW,OAAO,EAAEI,IAAI,EAAEV,QAAQ,CAACK,IAAI,CAAC,CAAC,CACxCqB,KAAK,CAACC,EAAE,IAAI;MACX,MAAMC,QAAQ,GAAG9B,SAAS,CAAC6B,EAAE,CAAC;MAC9B,IAAI,CAACC,QAAQ,CAACC,WAAW,CAACN,MAAM,CAAC,EAAE;QACjC,MAAMK,QAAQ;MAChB;MACAf,KAAK,CAACe,QAAQ,CAAC;IACjB,CAAC,CAAC;EACN,CAAC,EAAEf,KAAK,CAAC;AACX,CAAC","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}