{"ast":null,"code":"const pinflight = require('promise-inflight');\nconst spawn = require('./spawn.js');\nconst LRU = require('lru-cache');\nconst revsCache = new LRU({\n  max: 100,\n  maxAge: 5 * 60 * 1000\n});\nconst linesToRevs = require('./lines-to-revs.js');\nmodule.exports = async (repo, opts = {}) => {\n  if (!opts.noGitRevCache) {\n    const cached = revsCache.get(repo);\n    if (cached) {\n      return cached;\n    }\n  }\n  return pinflight(`ls-remote:${repo}`, () => spawn(['ls-remote', repo], opts).then(({\n    stdout\n  }) => linesToRevs(stdout.trim().split('\\n'))).then(revs => {\n    revsCache.set(repo, revs);\n    return revs;\n  }));\n};","map":{"version":3,"names":["pinflight","require","spawn","LRU","revsCache","max","maxAge","linesToRevs","module","exports","repo","opts","noGitRevCache","cached","get","then","stdout","trim","split","revs","set"],"sources":["C:/Users/Felo/node_modules/npm/node_modules/@npmcli/git/lib/revs.js"],"sourcesContent":["const pinflight = require('promise-inflight')\nconst spawn = require('./spawn.js')\nconst LRU = require('lru-cache')\n\nconst revsCache = new LRU({\n  max: 100,\n  maxAge: 5 * 60 * 1000\n})\n\nconst linesToRevs = require('./lines-to-revs.js')\n\nmodule.exports = async (repo, opts = {}) => {\n  if (!opts.noGitRevCache) {\n    const cached = revsCache.get(repo)\n    if (cached) {\n      return cached\n    }\n  }\n\n  return pinflight(`ls-remote:${repo}`, () =>\n    spawn(['ls-remote', repo], opts)\n      .then(({ stdout }) => linesToRevs(stdout.trim().split('\\n')))\n      .then(revs => {\n        revsCache.set(repo, revs)\n        return revs\n      })\n  )\n}\n"],"mappings":"AAAA,MAAMA,SAAS,GAAGC,OAAO,CAAC,kBAAkB,CAAC;AAC7C,MAAMC,KAAK,GAAGD,OAAO,CAAC,YAAY,CAAC;AACnC,MAAME,GAAG,GAAGF,OAAO,CAAC,WAAW,CAAC;AAEhC,MAAMG,SAAS,GAAG,IAAID,GAAG,CAAC;EACxBE,GAAG,EAAE,GAAG;EACRC,MAAM,EAAE,CAAC,GAAG,EAAE,GAAG;AACnB,CAAC,CAAC;AAEF,MAAMC,WAAW,GAAGN,OAAO,CAAC,oBAAoB,CAAC;AAEjDO,MAAM,CAACC,OAAO,GAAG,OAAOC,IAAI,EAAEC,IAAI,GAAG,CAAC,CAAC,KAAK;EAC1C,IAAI,CAACA,IAAI,CAACC,aAAa,EAAE;IACvB,MAAMC,MAAM,GAAGT,SAAS,CAACU,GAAG,CAACJ,IAAI,CAAC;IAClC,IAAIG,MAAM,EAAE;MACV,OAAOA,MAAM;IACf;EACF;EAEA,OAAOb,SAAS,CAAC,aAAaU,IAAI,EAAE,EAAE,MACpCR,KAAK,CAAC,CAAC,WAAW,EAAEQ,IAAI,CAAC,EAAEC,IAAI,CAAC,CAC7BI,IAAI,CAAC,CAAC;IAAEC;EAAO,CAAC,KAAKT,WAAW,CAACS,MAAM,CAACC,IAAI,CAAC,CAAC,CAACC,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC,CAC5DH,IAAI,CAACI,IAAI,IAAI;IACZf,SAAS,CAACgB,GAAG,CAACV,IAAI,EAAES,IAAI,CAAC;IACzB,OAAOA,IAAI;EACb,CAAC,CACL,CAAC;AACH,CAAC","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}