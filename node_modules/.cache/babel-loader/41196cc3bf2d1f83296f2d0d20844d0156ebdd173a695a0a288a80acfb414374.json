{"ast":null,"code":"'use strict';\n\nconst colors = require('../colors.js');\nconst install = require('./install.js');\nmodule.exports = (data, {\n  color\n}) => {\n  const summary = install.summary(data, {\n    color\n  });\n  const none = data.metadata.vulnerabilities.total === 0;\n  return none ? summary : fullReport(data, {\n    color,\n    summary\n  });\n};\nconst fullReport = (data, {\n  color,\n  summary\n}) => {\n  const c = colors(color);\n  const output = [c.white('# npm audit report'), ''];\n  const printed = new Set();\n  for (const [name, vuln] of Object.entries(data.vulnerabilities)) {\n    // only print starting from the top-level advisories\n    if (vuln.via.filter(v => typeof v !== 'string').length !== 0) output.push(printVuln(vuln, c, data.vulnerabilities));\n  }\n  output.push(summary);\n  return output.join('\\n');\n};\nconst printVuln = (vuln, c, vulnerabilities, printed = new Set(), indent = '') => {\n  if (printed.has(vuln)) return null;\n  printed.add(vuln);\n  const output = [];\n  output.push(c.white(vuln.name) + '  ' + vuln.range);\n  if (indent === '' && (vuln.severity !== 'low' || vuln.severity === 'info')) {\n    output.push(`Severity: ${c.severity(vuln.severity)}`);\n  }\n  for (const via of vuln.via) {\n    if (typeof via === 'string') {\n      output.push(`Depends on vulnerable versions of ${c.white(via)}`);\n    } else if (indent === '') {\n      output.push(`${c.white(via.title)} - ${via.url}`);\n    }\n  }\n  if (indent === '') {\n    const {\n      fixAvailable: fa\n    } = vuln;\n    if (fa === false) {\n      output.push(c.red('No fix available'));\n    } else if (fa === true) {\n      output.push(c.green('fix available') + ' via `npm audit fix`');\n    } else {\n      /* istanbul ignore else - should be impossible, just being cautious */\n      if (typeof fa === 'object' && indent === '') {\n        output.push(`${c.yellow('fix available')} via \\`npm audit fix --force\\``, `Will install ${fa.name}@${fa.version}` + `, which is ${fa.isSemVerMajor ? 'a breaking change' : 'outside the stated dependency range'}`);\n      }\n    }\n  }\n  for (const path of vuln.nodes) {\n    output.push(c.dim(path));\n  }\n  for (const effect of vuln.effects) {\n    const vuln = vulnerabilities[effect];\n    const e = printVuln(vuln, c, vulnerabilities, printed, '  ');\n    if (e) output.push(...e.split('\\n'));\n  }\n  if (indent === '') {\n    output.push('');\n  }\n  return output.map(l => `${indent}${l}`).join('\\n');\n};","map":{"version":3,"names":["colors","require","install","module","exports","data","color","summary","none","metadata","vulnerabilities","total","fullReport","c","output","white","printed","Set","name","vuln","Object","entries","via","filter","v","length","push","printVuln","join","indent","has","add","range","severity","title","url","fixAvailable","fa","red","green","yellow","version","isSemVerMajor","path","nodes","dim","effect","effects","e","split","map","l"],"sources":["C:/Users/Felo/node_modules/npm/node_modules/npm-audit-report/lib/reporters/detail.js"],"sourcesContent":["'use strict'\n\nconst colors = require('../colors.js')\nconst install = require('./install.js')\n\nmodule.exports = (data, { color }) => {\n  const summary = install.summary(data, { color })\n  const none = data.metadata.vulnerabilities.total === 0\n  return none ? summary : fullReport(data, {color, summary})\n}\n\nconst fullReport = (data, { color, summary }) => {\n  const c = colors(color)\n  const output = [c.white('# npm audit report'), '']\n\n  const printed = new Set()\n  for (const [name, vuln] of Object.entries(data.vulnerabilities)) {\n    // only print starting from the top-level advisories\n    if (vuln.via.filter(v => typeof v !== 'string').length !== 0)\n      output.push(printVuln(vuln, c, data.vulnerabilities))\n  }\n\n  output.push(summary)\n\n  return output.join('\\n')\n}\n\nconst printVuln = (vuln, c, vulnerabilities, printed = new Set(), indent = '') => {\n  if (printed.has(vuln))\n    return null\n\n  printed.add(vuln)\n  const output = []\n\n  output.push(c.white(vuln.name) + '  ' + vuln.range)\n\n  if (indent === '' && (vuln.severity !== 'low' || vuln.severity === 'info')) {\n    output.push(`Severity: ${c.severity(vuln.severity)}`)\n  }\n\n  for (const via of vuln.via) {\n    if (typeof via === 'string') {\n      output.push(`Depends on vulnerable versions of ${c.white(via)}`)\n    } else if (indent === '') {\n      output.push(`${c.white(via.title)} - ${via.url}`)\n    }\n  }\n\n  if (indent === '') {\n    const { fixAvailable: fa } = vuln\n    if (fa === false) {\n      output.push(c.red('No fix available'))\n    } else if (fa === true) {\n      output.push(c.green('fix available') + ' via `npm audit fix`')\n    } else {\n      /* istanbul ignore else - should be impossible, just being cautious */\n      if (typeof fa === 'object' && indent === '') {\n        output.push(\n          `${c.yellow('fix available')} via \\`npm audit fix --force\\``,\n          `Will install ${fa.name}@${fa.version}` +\n          `, which is ${fa.isSemVerMajor ? 'a breaking change' :\n            'outside the stated dependency range' }`\n        )\n      }\n    }\n  }\n\n  for (const path of vuln.nodes) {\n    output.push(c.dim(path))\n  }\n\n  for (const effect of vuln.effects) {\n    const vuln = vulnerabilities[effect]\n    const e = printVuln(vuln, c, vulnerabilities, printed, '  ')\n    if (e)\n      output.push(...e.split('\\n'))\n  }\n\n  if (indent === '') {\n    output.push('')\n  }\n\n  return output.map(l => `${indent}${l}`).join('\\n')\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}